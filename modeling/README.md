# 경제지표 LSTM 예측 모델링

## 개요

PyTorch 기반 LSTM(Long Short-Term Memory) 신경망을 활용한 한국 경제지표 예측 시스템입니다. ECOS(한국은행 경제통계시스템) 데이터를 활용하여 건설업 관련 핵심 경제지표들의 미래 동향을 예측합니다.

## 주요 특징

### 예측 모델
- **딥러닝 모델**: PyTorch LSTM 네트워크
- **예측 방식**: 다변량 시계열 예측 (차분값 기반)
- **하이퍼파라미터 최적화**: Optuna를 통한 자동 튜닝
- **예측 기간**: 3개월 미래 예측

### 예측 대상 지표 (차분값)
1. **건설업경기실사지수 (construction_bsi_actual_diff)**
2. **기준금리 (base_rate_diff)**
3. **주택매매가격지수 (housing_sale_price_diff)**
4. **통화공급량 M2 증가율 (m2_growth_diff)**
5. **신용스프레드 (credit_spread_diff)**

### 기술 스택
- **딥러닝 프레임워크**: PyTorch
- **최적화**: Optuna (베이지안 최적화)
- **데이터 처리**: pandas, numpy
- **시각화**: matplotlib, seaborn
- **성능 평가**: scikit-learn

## 모델 아키텍처

## 모델 아키텍처

### MultivariateLSTM 클래스
```python
class MultivariateLSTM(nn.Module):
    def __init__(self, input_size, hidden_size, num_layers, output_size, dropout_rate=0.2):
        - LSTM 레이어: 다층 구조, 배치 우선 처리
        - 드롭아웃: 과적합 방지
        - 완전연결층: LSTM 출력을 타겟 차원으로 변환
```

### 주요 구성 요소
- **입력 크기**: 선택된 특성 수 (상관관계 기반 자동 선택)
- **은닉 크기**: 32-128 (하이퍼파라미터 튜닝으로 결정)
- **레이어 수**: 1-2층 (과적합 방지를 위한 제한)
- **드롭아웃**: 0.1-0.4 (정규화)
- **시퀀스 길이**: 12-30 (과거 데이터 참조 기간)

### 손실 함수 옵션
- **MSE (Mean Squared Error)**: 기본 회귀 손실
- **MAE (Mean Absolute Error)**: 이상치에 강건
- **Huber Loss**: MSE와 MAE의 균형

## 데이터 처리 파이프라인

### 1. 데이터 전처리
- **차분 변환**: 비정상성 제거를 위한 1차 차분 적용
- **특성 엔지니어링**: 이동평균, 변화율, 지연 특성 생성
- **결측값 처리**: 선형 보간법 적용

### 2. 특성 선택
- **다중공선성 제거**: 상관계수 0.95 이상 특성 제거
- **타겟 상관관계 기반 선택**: 타겟과의 평균 상관계수 순위
- **최종 특성 수**: 상위 50% 또는 최소 20개

### 3. 시계열 분할
- **시간 순서 유지**: 과거 데이터로 훈련, 미래 데이터로 테스트
- **데이터 누출 방지**: 훈련 세트에서만 스케일러 학습
- **분할 비율**: 훈련 64%, 검증 16%, 테스트 20%

### 4. 스케일링
- **StandardScaler**: 평균 0, 분산 1로 정규화
- **배치별 적용**: 각 시퀀스별로 독립적 스케일링
- **역변환 지원**: 예측값을 원래 척도로 복원

## 하이퍼파라미터 최적화

### Optuna 기반 베이지안 최적화
- **최적화 범위**:
  - hidden_size: [32, 64, 96, 128]
  - num_layers: [1, 2]
  - dropout_rate: [0.1, 0.4]
  - learning_rate: [1e-4, 5e-3] (로그 스케일)
  - batch_size: [16, 32, 64]
  - seq_length: [12, 18, 24, 30]
  - optimizer_type: ['Adam', 'AdamW']

### 프루닝 및 조기종료
- **MedianPruner**: 성능이 낮은 시행 조기 종료
- **Early Stopping**: 검증 성능 개선 없을 시 종료
- **시행 수**: 최대 50회 (600초 제한)

## 성능 평가

### 베이스라인 모델
1. **Naive 모델**: 마지막 값 반복 예측
2. **계절성 Naive**: 12개월 전 값 반복 예측
3. **평균 모델**: 훈련 데이터 평균값 예측

### 평가 지표
- **RMSE**: Root Mean Square Error
- **MAE**: Mean Absolute Error  
- **R²**: 결정계수 (설명력)
- **방향성 정확도**: 상승/하락 방향 예측 정확도

### 시각화
- **학습 곡선**: 훈련/검증 손실 추이
- **산점도**: 실제 vs 예측값 비교
- **시계열 그래프**: 과거 데이터와 미래 예측 연결
- **성능 히트맵**: 지표별 성능 메트릭 종합

## 파일 구조

```
modeling/
├── ecos_monthly_data.csv           # ECOS 월별 경제지표 데이터 (189행 × 27열)
├── LSTM_predict_final.ipynb        # 메인 LSTM 예측 노트북 (9개 셀)
├── README.md                       # 프로젝트 문서 (본 파일)
└── output/                         # 결과 파일 출력 디렉토리
    ├── lstm_monthly_predictions.csv      # 월별 예측 결과
    ├── lstm_quarterly_predictions.csv    # 분기별 예측 결과 
    ├── lstm_model_checkpoint.pth         # 모델 체크포인트
    └── lstm_performance_metrics.csv      # 성능 평가 지표
```

## 사용법

### 1. 환경 설정
```python
# 필요한 라이브러리가 노트북 첫 번째 셀에서 자동 설치됩니다
import torch
import optuna
import pandas as pd
import numpy as np
```

### 2. GPU 설정 확인
```python
device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')
print(f"Using device: {device}")
```

### 3. 노트북 실행 순서

#### 셀 1: 라이브러리 Import 및 GPU 설정
- PyTorch, Optuna, 데이터 처리 라이브러리 import
- CUDA 사용 가능 시 GPU 활용 설정

#### 셀 2: 데이터 로드 및 전처리
- `ecos_monthly_data.csv` 파일 로드
- 차분 변환을 통한 비정상성 제거
- 특성 엔지니어링 (이동평균, 지연변수 등)
- 상관관계 기반 특성 선택

#### 셀 3: 데이터 준비 함수 정의
- 시계열 시퀀스 생성 함수
- 스케일링 누출 방지 데이터 분할 함수
- 베이스라인 모델 생성 함수

#### 셀 4: LSTM 모델 및 학습 함수 정의
- MultivariateLSTM 클래스 정의
- 개선된 학습 함수 (그래디언트 클리핑, 스케줄러)
- 다중 스텝 예측 함수

#### 셀 5: 하이퍼파라미터 최적화
- Optuna 목적함수 정의
- 베이스라인 모델 평가
- 50회 시행으로 최적 파라미터 탐색

#### 셀 6: 최적 모델 학습 및 예측
- 최적 하이퍼파라미터로 모델 생성
- 조기종료 포함 완전 학습
- 테스트 데이터 예측 수행

#### 셀 7: 미래 예측
- 차분값을 원시값으로 복원하는 미래 예측
- 3개월 미래 동향 예측
- 분기별 평균 계산

#### 셀 8: 성능 평가 및 시각화
- LSTM vs 베이스라인 모델 비교
- 학습 곡선, 예측 비교 시각화
- 성능 히트맵 생성

#### 셀 9: 결과 저장
- 월별/분기별 예측 결과 CSV 저장
- 모델 체크포인트 저장 (.pth)
- 성능 메트릭 저장

## 실행 결과

### 생성되는 파일들
1. **lstm_monthly_predictions.csv**: 3개월 미래 월별 예측값
2. **lstm_quarterly_predictions.csv**: 분기별 평균 예측값
3. **lstm_model_checkpoint.pth**: 학습된 모델 저장 (하이퍼파라미터 포함)
4. **lstm_performance_metrics.csv**: 각 지표별 RMSE, MAE, R², 방향성 정확도

### 예측 결과 해석
- **차분값**: 전월 대비 변화량 예측
- **원시값**: 차분값을 누적하여 실제 지표값 복원
- **불확실성**: 과거 표준편차를 활용한 예측 구간 표시

## 활용 방안

### 정책 결정 지원
- **건설업 정책**: 건설업경기실사지수 예측을 통한 업계 동향 파악
- **통화정책**: 기준금리와 신용스프레드 예측으로 금융정책 방향성 제시
- **부동산 정책**: 주택매매가격지수 예측으로 부동산 시장 안정화 정책 수립

### 투자 의사결정
- **섹터 로테이션**: 경제지표 예측을 통한 투자 섹터 선택
- **리스크 관리**: 신용스프레드 급증 시점 사전 감지
- **유동성 관리**: M2 증가율 예측으로 유동성 환경 분석

### 연구 및 개발
- **모델 확장**: 추가 경제지표 및 외부 변수 통합
- **앙상블**: 다른 머신러닝 모델과의 결합
- **실시간 예측**: 스트리밍 데이터 기반 실시간 업데이트

## 한계 및 개선사항

### 현재 한계
1. **구조적 변화**: 코로나19, 정책 변화 등 구조적 충격 반영 제한
2. **외부 변수**: 국제 경제상황, 지정학적 요인 미포함
3. **예측 기간**: 3개월 단기 예측 위주

### 개선 방향
1. **모델 다양화**: Transformer, GRU 등 다른 아키텍처 시도
2. **변수 확장**: 국제 경제지표, 정책 더미 추가
3. **불확실성 정량화**: 베이지안 딥러닝 적용
4. **실시간 시스템**: 자동 데이터 수집 및 예측 파이프라인 구축

## 기술 요구사항

### 하드웨어
- **메모리**: 최소 8GB RAM (16GB 권장)
- **GPU**: CUDA 지원 GPU (선택사항, 훈련 속도 향상)
- **저장공간**: 최소 1GB (데이터 및 결과 파일)

### 소프트웨어
- **Python**: 3.8 이상
- **PyTorch**: 1.12 이상
- **Optuna**: 3.0 이상
- **pandas**: 1.5 이상
- **scikit-learn**: 1.1 이상

### 실행 시간
- **GPU 사용시**: 약 10-15분
- **CPU 사용시**: 약 30-60분
- **하이퍼파라미터 튜닝**: 전체 실행 시간의 80%

## 문의 및 지원

본 프로젝트는 한국 건설업 관련 경제지표 예측을 위한 연구용 도구입니다. 실제 투자나 정책 결정에 활용 시에는 충분한 검증과 전문가 상담을 권장합니다.
