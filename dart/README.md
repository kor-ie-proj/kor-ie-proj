# ğŸ“‹ DART ì¬ë¬´ë°ì´í„° ìˆ˜ì§‘

ì „ìê³µì‹œì‹œìŠ¤í…œ(DART) APIë¥¼ í™œìš©í•œ ê±´ì„¤ì—… ê¸°ì—… ì¬ë¬´ì œí‘œ ìë™ ìˆ˜ì§‘ ëª¨ë“ˆ

## ğŸ“‹ ê°œìš”

ê±´ì„¤ì—… 10ê°œ ì£¼ìš” ê¸°ì—…ì˜ ë¶„ê¸°ë³„ ì¬ë¬´ì œí‘œë¥¼ DART APIë¥¼ í†µí•´ ìˆ˜ì§‘í•˜ê³  MySQL ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•©ë‹ˆë‹¤.

## ğŸ¢ ëŒ€ìƒ ê¸°ì—… (10ê°œì‚¬)

| ê¸°ì—…ëª… | ì£¼ì‹ì½”ë“œ | íŠ¹ì§• |
|--------|----------|------|
| ì‚¼ì„±ë¬¼ì‚° | 028260 | ëŒ€í˜• ì¢…í•©ê±´ì„¤ |
| íš¨ì„±ì¤‘ê³µì—… | 298040 | í”ŒëœíŠ¸ ì „ë¬¸ |
| í˜„ëŒ€ê±´ì„¤ | 000720 | ëŒ€í˜• ì¢…í•©ê±´ì„¤ |
| HJì¤‘ê³µì—… | 097230 | ì¤‘ê³µì—… ê±´ì„¤ |
| DLì´ì•¤ì”¨ | 375500 | ì¢…í•©ê±´ì„¤ |
| GSê±´ì„¤ | 006360 | ëŒ€í˜• ì¢…í•©ê±´ì„¤ |
| ëŒ€ìš°ê±´ì„¤ | 047040 | ì¢…í•©ê±´ì„¤ |
| HDCí˜„ëŒ€ì‚°ì—…ê°œë°œ | 294870 | ë„ì‹œê°œë°œ |
| ì•„ì´ì—ìŠ¤ë™ì„œ | 010780 | ì¤‘ê²¬ ê±´ì„¤ |
| íƒœì˜ê±´ì„¤ | 009410 | ì¤‘ê²¬ ê±´ì„¤ |

## ğŸ“Š ìˆ˜ì§‘ ë°ì´í„°

### ì¬ë¬´ìƒíƒœí‘œ
- **ìì‚°ì´ê³„**: ê¸°ì—…ì˜ ì „ì²´ ìì‚° ê·œëª¨
- **ë¶€ì±„ì´ê³„**: ê¸°ì—…ì˜ ì „ì²´ ë¶€ì±„ ê·œëª¨  
- **ìë³¸ì´ê³„**: ê¸°ì—…ì˜ ìˆœìì‚° (ìì‚°-ë¶€ì±„)

### ì†ìµê³„ì‚°ì„œ
- **ë§¤ì¶œì•¡**: ë¶„ê¸°ë³„ ë§¤ì¶œì•¡ (ëˆ„ì  â†’ ë¶„ê¸° ë³€í™˜)
- **ì˜ì—…ì´ìµ**: ë¶„ê¸°ë³„ ì˜ì—…ì´ìµ (ëˆ„ì  â†’ ë¶„ê¸° ë³€í™˜)
- **ë¶„ê¸°ìˆœì´ìµ**: ë¶„ê¸°ë³„ ë‹¹ê¸°ìˆœì´ìµ (ëˆ„ì  â†’ ë¶„ê¸° ë³€í™˜)

### ë°ì´í„° íŠ¹ì§•
- **ê¸°ê°„**: 2015ë…„ 4ë¶„ê¸° ~ 2025ë…„ 2ë¶„ê¸°
- **ì£¼ê¸°**: ë¶„ê¸°ë³„ (Q1, Q2, Q3, Q4)
- **í˜•íƒœ**: ì—°ê²°ì¬ë¬´ì œí‘œ ìš°ì„ , ë³„ë„ì¬ë¬´ì œí‘œ ë³´ì™„
- **ë‹¨ìœ„**: ì–µì› (ì •ê·œí™” ì ìš©)

## ğŸ“ íŒŒì¼ êµ¬ì¡°

```
dart/
â”œâ”€â”€ dart_data.ipynb           # ë©”ì¸ ìˆ˜ì§‘ ë…¸íŠ¸ë¶
â”œâ”€â”€ dart_out/                # ìˆ˜ì§‘ ê²°ê³¼ ì €ì¥ í´ë”
â”‚   â”œâ”€â”€ ê±´ì„¤10_11ë…„ë¡œë“œ_2015~2025_ì—°ê²°_ë¶„ê¸°ì¬ë¬´_ì •ê·œí™”.csv
â”‚   â”œâ”€â”€ ê±´ì„¤10_11ë…„ë¡œë“œ_2015~2025_ì—°ê²°_ë¶„ê¸°ì¬ë¬´_ì •ê·œí™”.xlsx
â”‚   â””â”€â”€ ìˆ˜ê¸°ì…ë ¥_dart_ê²°ì¸¡ì¹˜.csv  # ê²°ì¸¡ì¹˜ ë³´ì™„ ë°ì´í„°
â””â”€â”€ README.md                # ì´ íŒŒì¼
```

## ğŸš€ ì‚¬ìš©ë²•

### 1. í™˜ê²½ ì„¤ì •

#### DART API í‚¤ ë°œê¸‰
1. [DART ì‚¬ì´íŠ¸](https://opendart.fss.or.kr/) ì ‘ì†
2. íšŒì›ê°€ì… ë° ë¡œê·¸ì¸
3. API ì¸ì¦í‚¤ ë°œê¸‰ ì‹ ì²­
4. `.env` íŒŒì¼ì— API í‚¤ ì„¤ì •

```env
DART_API_KEY=your_dart_api_key_here
```

#### í•„ìš” íŒ¨í‚¤ì§€ ì„¤ì¹˜
```bash
pip install dart-fss pandas tqdm tenacity openpyxl
```

### 2. ë°ì´í„° ìˆ˜ì§‘ ì‹¤í–‰

#### Jupyter Notebook ì‹¤í–‰
```bash
jupyter notebook dart_data.ipynb
```

#### ì…€ë³„ ì‹¤í–‰ ìˆœì„œ
1. **íŒ¨í‚¤ì§€ ì„¤ì¹˜ ë° Import** (ì…€ 1-2)
2. **DART API ì„¤ì • ë° ë°ì´í„° ìˆ˜ì§‘** (ì…€ 3)
3. **ìˆ˜ê¸°ì…ë ¥ ë°ì´í„° ë³‘í•©** (ì…€ 4)
4. **ë°ì´í„° ì •ê·œí™” ë° íŒŒì¼ ì €ì¥** (ì…€ 5)
5. **ë°ì´í„°ë² ì´ìŠ¤ ì €ì¥** (ì…€ 6-7)

### 3. ì‹¤í–‰ ê²°ê³¼

- **CSV/Excel íŒŒì¼**: `dart_out/` í´ë”ì— ì €ì¥
- **MySQL ì €ì¥**: `dart_data` í…Œì´ë¸”ì— ì €ì¥
- **ì½˜ì†” ì¶œë ¥**: ìˆ˜ì§‘ ì§„í–‰ìƒí™© ë° ê²°ê³¼ í†µê³„

## ğŸ”§ ì£¼ìš” ê¸°ëŠ¥

### ì§€ëŠ¥í˜• ë°ì´í„° ìˆ˜ì§‘
- **ì•µì»¤ë§ ì‹œìŠ¤í…œ**: ì£¼ì‹ì½”ë“œ ê¸°ë°˜ ì •í™•í•œ ê¸°ì—… ì‹ë³„
- **ì—°ê²°ì¬ë¬´ì œí‘œ ìš°ì„ **: CFS â†’ OFS ìˆœì„œë¡œ ìˆ˜ì§‘
- **ë¼ì¸ë¦¬ì§€ í´ë°±**: í•©ë³‘/ë¶„í•  ê¸°ì—…ì˜ ê³¼ê±° ë°ì´í„° ë³´ì™„

### ë°ì´í„° í’ˆì§ˆ ê´€ë¦¬
- **ëˆ„ì ê°’ â†’ ë¶„ê¸°ê°’ ë³€í™˜**: ì†ìµê³„ì‚°ì„œ ì •í™•í•œ ë¶„ê¸° ì‹¤ì  ê³„ì‚°
- **ê²°ì¸¡ì¹˜ ë³´ì™„**: ìˆ˜ê¸°ì…ë ¥ ë°ì´í„°ë¡œ API ëˆ„ë½ë¶„ ë³´ì™„
- **ë°ì´í„° ê²€ì¦**: ìˆ˜ì§‘ëœ ë°ì´í„°ì˜ ë…¼ë¦¬ì  ì¼ê´€ì„± ê²€ì¦

### ìë™ ì „ì²˜ë¦¬
- **ì •ê·œí™”**: ì› ë‹¨ìœ„ â†’ ì–µì› ë‹¨ìœ„ ë³€í™˜
- **ì¤‘ë³µ ì œê±°**: ë™ì¼ ê¸°ì—…-ì—°ë„-ë¶„ê¸° ë°ì´í„° ì¤‘ë³µ ë°©ì§€
- **í˜•ì‹ í†µì¼**: ë‚ ì§œ, ìˆ«ì í˜•ì‹ í‘œì¤€í™”

## ğŸ“Š ë°ì´í„° êµ¬ì¡°

### ìˆ˜ì§‘ ë°ì´í„° í˜•ì‹
```csv
corp_name,corp_code,year,quarter,report_date,ìì‚°ì´ê³„,ë¶€ì±„ì´ê³„,ìë³¸ì´ê³„,ë§¤ì¶œì•¡,ì˜ì—…ì´ìµ,ë¶„ê¸°ìˆœì´ìµ
ì‚¼ì„±ë¬¼ì‚°,00126434,2024,Q1,2024-03-31,125430.50,67890.25,57540.25,18750.30,1250.75,980.45
```

### MySQL í…Œì´ë¸” êµ¬ì¡°
```sql
CREATE TABLE dart_data (
    id INT AUTO_INCREMENT PRIMARY KEY,
    corp_name VARCHAR(100) NOT NULL,
    corp_code VARCHAR(20) NOT NULL,
    year INT NOT NULL,
    quarter VARCHAR(10) NOT NULL,
    report_date DATE,
    total_assets DECIMAL(20,2),      -- ìì‚°ì´ê³„ (ì–µì›)
    total_liabilities DECIMAL(20,2), -- ë¶€ì±„ì´ê³„ (ì–µì›)
    total_equity DECIMAL(20,2),      -- ìë³¸ì´ê³„ (ì–µì›)
    revenue DECIMAL(20,2),           -- ë§¤ì¶œì•¡ (ì–µì›)
    operating_profit DECIMAL(20,2),  -- ì˜ì—…ì´ìµ (ì–µì›)
    quarterly_profit DECIMAL(20,2),  -- ë¶„ê¸°ìˆœì´ìµ (ì–µì›)
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_corp_year_quarter (corp_code, year, quarter)
);
```

## ğŸ” ìˆ˜ì§‘ ë¡œì§

### 1. ê¸°ì—… ì‹ë³„ ë° ì•µì»¤ë§
```python
# ì£¼ì‹ì½”ë“œ ê¸°ë°˜ ì •í™•í•œ corp_code ë§¤í•‘
PRIMARY_STOCK_ANCHOR = {
    "ì‚¼ì„±ë¬¼ì‚°": "028260",    # í•©ë³‘ í›„ ì‹ ì£¼
    "íƒœì˜ê±´ì„¤": "009410"
}

# ê³¼ê±° ê¸°ì—…ëª… ë§¤í•‘ (ë¼ì¸ë¦¬ì§€)
LINEAGE_RULES = {
    "DLì´ì•¤ì”¨": ("ëŒ€ë¦¼ì‚°ì—…", 2020),         # 2020ë…„ê¹Œì§€ ëŒ€ë¦¼ì‚°ì—… ë°ì´í„°
    "HDCí˜„ëŒ€ì‚°ì—…ê°œë°œ": ("í˜„ëŒ€ì‚°ì—…ê°œë°œ", 2017) # 2017ë…„ê¹Œì§€ í˜„ëŒ€ì‚°ì—…ê°œë°œ ë°ì´í„°
}
```

### 2. ì¬ë¬´ì œí‘œ ìˆ˜ì§‘ ì „ëµ
```python
# ì—°ê²°ì¬ë¬´ì œí‘œ(CFS) ìš°ì„ , ë³„ë„ì¬ë¬´ì œí‘œ(OFS) ë³´ì™„
def _probe_fs_div_for_year(corp_code, year):
    # ì—°ë„ë³„ë¡œ CFS ê°€ìš©ì„± í™•ì¸
    # CFS ìˆìœ¼ë©´ CFS, ì—†ìœ¼ë©´ OFS ì‚¬ìš©
```

### 3. ëˆ„ì ê°’ â†’ ë¶„ê¸°ê°’ ë³€í™˜
```python
# ì†ìµê³„ì‚°ì„œ: ëˆ„ì ê°’ì„ ë¶„ê¸°ê°’ìœ¼ë¡œ ë³€í™˜
Q2_ë§¤ì¶œì•¡ = H1_ë§¤ì¶œì•¡ - Q1_ë§¤ì¶œì•¡
Q3_ë§¤ì¶œì•¡ = 3Q_ë§¤ì¶œì•¡ - H1_ë§¤ì¶œì•¡  
Q4_ë§¤ì¶œì•¡ = Annual_ë§¤ì¶œì•¡ - 3Q_ë§¤ì¶œì•¡

# ì¬ë¬´ìƒíƒœí‘œ: ë¶„ê¸°ë§ ì”ì•¡ ê·¸ëŒ€ë¡œ ì‚¬ìš©
```

## ğŸ” ëª¨ë‹ˆí„°ë§

### ìˆ˜ì§‘ ìƒíƒœ í™•ì¸
```python
# ë…¸íŠ¸ë¶ ë‚´ í™•ì¸ í•¨ìˆ˜
check_database_results()

# ì¶œë ¥ ë‚´ìš©:
# - ì´ ì €ì¥ëœ ë ˆì½”ë“œ ìˆ˜
# - ê¸°ì—…ë³„ ë ˆì½”ë“œ ìˆ˜
# - ì—°ë„ë³„ ë ˆì½”ë“œ ìˆ˜  
# - ìµœê·¼ ë°ì´í„° ìƒ˜í”Œ
```

### ë°ì´í„° í’ˆì§ˆ ê²€ì¦
```python
# ê²°ì¸¡ì¹˜ í˜„í™©
missing_info = result_df.isnull().sum()

# ê¸°ì—…ë³„ ë°ì´í„° ì™„ì„±ë„
corp_data_count = result_df['corp_name'].value_counts()

# ì—°ë„ë³„ ë°ì´í„° ë¶„í¬
year_distribution = result_df.groupby(['year', 'quarter']).size()
```

## âš ï¸ ì£¼ì˜ì‚¬í•­

### ë°ì´í„° íŠ¹ì„±
- **ë³´ê³  ì§€ì—°**: ë¶„ê¸° ì¢…ë£Œ í›„ 45ì¼ ì´ë‚´ ê³µì‹œ
- **ì •ì • ê³µì‹œ**: ê¸°ë°œí‘œ ì¬ë¬´ì œí‘œ ìˆ˜ì • ê°€ëŠ¥
- **ë¹„êµ ë¶ˆê°€**: íšŒê³„ê¸°ì¤€ ë³€ê²½ì— ë”°ë¥¸ ë¹„êµ ì œì•½

### ê²°ì¸¡ì¹˜ ì›ì¸
- **ì‹ ê·œ ìƒì¥**: 2015ë…„ ì´í›„ ìƒì¥ ê¸°ì—…
- **ê°ì‚¬ ì§€ì—°**: ê°ì‚¬ë³´ê³ ì„œ ì œì¶œ ì§€ì—°
- **ì˜ì—… ì¤‘ë‹¨**: ì¼ì‹œì  ì˜ì—… ì¤‘ë‹¨ ê¸°ê°„
- **í•©ë³‘/ë¶„í• **: ê¸°ì—… êµ¬ì¡°ì¡°ì •

## ğŸ“ˆ ì—…ë°ì´íŠ¸ ì£¼ê¸°

### ê¶Œì¥ ì‹¤í–‰ ì£¼ê¸°
- **ë¶„ê¸°ë³„ ìˆ˜ì§‘**: ë¶„ê¸° ì¢…ë£Œ í›„ 2ê°œì›” ê²½ê³¼ ì‹œì 
- **ì›”ë³„ í™•ì¸**: ì •ì •ê³µì‹œ ë°˜ì˜ì„ ìœ„í•œ ì›”ë³„ í™•ì¸
- **ì—°ë§ ë°±ì—…**: ì—°ë§ ì „ì²´ ë°ì´í„° ë°±ì—…

### ì‹¤í–‰ ì‹œì 
```
Q1 (1-3ì›”) ë°ì´í„°: 5ì›” ì¤‘ìˆœ ìˆ˜ì§‘
Q2 (4-6ì›”) ë°ì´í„°: 8ì›” ì¤‘ìˆœ ìˆ˜ì§‘  
Q3 (7-9ì›”) ë°ì´í„°: 11ì›” ì¤‘ìˆœ ìˆ˜ì§‘
Q4 (10-12ì›”) ë°ì´í„°: 3ì›” ì¤‘ìˆœ ìˆ˜ì§‘
```

## ğŸ› ï¸ ë¬¸ì œ í•´ê²°

### ì¼ë°˜ì ì¸ ì˜¤ë¥˜
```python
# 1. API í‚¤ ì˜¤ë¥˜
RuntimeError: DART_API_KEY í™˜ê²½ë³€ìˆ˜ê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.
â†’ .env íŒŒì¼ì˜ DART_API_KEY í™•ì¸

# 2. ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜  
requests.exceptions.ConnectionError
â†’ ì¸í„°ë„· ì—°ê²° ë° ë°©í™”ë²½ í™•ì¸

# 3. ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì˜¤ë¥˜
pymysql.err.OperationalError
â†’ MySQL ì„œë¹„ìŠ¤ ì‹¤í–‰ ë° ì—°ê²° ì •ë³´ í™•ì¸

# 4. ë©”ëª¨ë¦¬ ì˜¤ë¥˜
MemoryError
â†’ ìˆ˜ì§‘ ê¸°ê°„ ë‹¨ì¶• ë˜ëŠ” ë°°ì¹˜ í¬ê¸° ì¡°ì •
```

### ë°ì´í„° ê²€ì¦
```python
# ë…¼ë¦¬ì  ì¼ê´€ì„± í™•ì¸
assert (result_df['ìì‚°ì´ê³„'] >= result_df['ë¶€ì±„ì´ê³„']).all()
assert (result_df['ìì‚°ì´ê³„'] == result_df['ë¶€ì±„ì´ê³„'] + result_df['ìë³¸ì´ê³„']).all()

# ì´ìƒì¹˜ íƒì§€
Q1 = result_df['ë§¤ì¶œì•¡'].quantile(0.25)
Q3 = result_df['ë§¤ì¶œì•¡'].quantile(0.75)
IQR = Q3 - Q1
outliers = result_df[(result_df['ë§¤ì¶œì•¡'] < Q1-1.5*IQR) | 
                    (result_df['ë§¤ì¶œì•¡'] > Q3+1.5*IQR)]
```


